var e=require("@chriscdn/promise-semaphore");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=/*#__PURE__*/r(require("quick-lru"));exports.Memoize=function(e,r){var t,i,u;void 0===r&&(r={});var l=null!=(t=r.maxSize)?t:1e3,a=null!=(i=r.shouldCache)?i:function(){return!0},o=null!=(u=r.resolver)?u:function(){return JSON.stringify([].slice.call(arguments))},c=new n.default({maxAge:r.maxAge,maxSize:l}),s=function(){var r=[].slice.call(arguments),n=o.apply(void 0,r);if(c.has(n))return c.get(n);var t=e.apply(void 0,r);return a(t,n)&&c.set(n,t),t};return s.cache=c,s},exports.MemoizeAsync=function(r,t){var i,u,l;void 0===t&&(t={});var a=null!=(i=t.maxSize)?i:1e3,o=null!=(u=t.shouldCache)?u:function(){return!0},c=null!=(l=t.resolver)?l:function(){return JSON.stringify([].slice.call(arguments))},s=new n.default({maxAge:t.maxAge,maxSize:a}),f=new e.Semaphore,v=function(){try{var e=[].slice.call(arguments),n=c.apply(void 0,e);return Promise.resolve(function(t,i){try{var u=Promise.resolve(f.acquire(n)).then(function(){return s.has(n)?s.get(n):Promise.resolve(r.apply(void 0,e)).then(function(e){return o(e,n)&&s.set(n,e),e})})}catch(e){return i(!0,e)}return u&&u.then?u.then(i.bind(null,!1),i.bind(null,!0)):i(!1,u)}(0,function(e,r){if(f.release(n),e)throw r;return r}))}catch(e){return Promise.reject(e)}};return v.cache=s,v};
//# sourceMappingURL=memoize.cjs.map
