var e=require("@chriscdn/promise-semaphore"),r=require("quick-lru");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=/*#__PURE__*/n(e),u=/*#__PURE__*/n(r);exports.Memoize=function(e,r){var n,t,i;void 0===r&&(r={});var l=null!=(n=r.maxSize)?n:1e3,a=null!=(t=r.shouldCache)?t:function(){return!0},o=null!=(i=r.resolver)?i:function(){return JSON.stringify([].slice.call(arguments))},c=new u.default({maxAge:r.maxAge,maxSize:l}),s=function(){var r=[].slice.call(arguments),n=o.apply(void 0,r);if(c.has(n))return c.get(n);var t=e.apply(void 0,r);return a(t,n)&&c.set(n,t),t};return s.cache=c,s},exports.MemoizeAsync=function(e,r){var n,i,l;void 0===r&&(r={});var a=r.maxAge,o=null!=(n=r.maxSize)?n:1e3,c=null!=(i=r.shouldCache)?i:function(){return!0},s=null!=(l=r.resolver)?l:function(){return JSON.stringify([].slice.call(arguments))},f=new t.default,v=new u.default({maxAge:a,maxSize:o}),h=function(){try{var r=[].slice.call(arguments),n=s.apply(void 0,r);return Promise.resolve(v.has(n)?v.get(n):function(t,u){try{var i=Promise.resolve(f.acquire(n)).then(function(){return v.has(n)?v.get(n):Promise.resolve(e.apply(void 0,r)).then(function(e){return c(e,n)&&v.set(n,e),e})})}catch(e){return u(!0,e)}return i&&i.then?i.then(u.bind(null,!1),u.bind(null,!0)):u(!1,i)}(0,function(e,r){if(f.release(n),e)throw r;return r}))}catch(e){return Promise.reject(e)}};return h.cache=v,h};
//# sourceMappingURL=memoize.cjs.map
