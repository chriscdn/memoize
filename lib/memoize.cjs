var e=require("@chriscdn/promise-semaphore"),r=require("quick-lru");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=/*#__PURE__*/n(e),i=/*#__PURE__*/n(r);exports.Memoize=function(e,r){var n,t;void 0===r&&(r={});var a=null!=(n=r.maxSize)?n:1e3,u=null!=(t=r.resolver)?t:function(){return JSON.stringify([].slice.call(arguments))},l=new i.default({maxAge:r.maxAge,maxSize:a}),o=function(){var r=[].slice.call(arguments),n=u.apply(void 0,r);if(l.has(n))return l.get(n);var t=e.apply(void 0,r);return l.set(n,t),t};return o.cache=l,o},exports.MemoizeAsync=function(e,r){var n,a;void 0===r&&(r={});var u=r.maxAge,l=null!=(n=r.maxSize)?n:1e3,o=null!=(a=r.resolver)?a:function(){return JSON.stringify([].slice.call(arguments))},c=new t.default,s=new i.default({maxAge:u,maxSize:l}),f=function(){try{var r=[].slice.call(arguments),n=o.apply(void 0,r);return Promise.resolve(s.has(n)?s.get(n):function(t,i){try{var a=Promise.resolve(c.acquire(n)).then(function(){return s.has(n)?s.get(n):Promise.resolve(e.apply(void 0,r)).then(function(e){return s.set(n,e),e})})}catch(e){return i(!0,e)}return a&&a.then?a.then(i.bind(null,!1),i.bind(null,!0)):i(!1,a)}(0,function(e,r){if(c.release(n),e)throw r;return r}))}catch(e){return Promise.reject(e)}};return f.cache=s,f};
//# sourceMappingURL=memoize.cjs.map
