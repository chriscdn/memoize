var e=require("lru-cache");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=/*#__PURE__*/r(require("@chriscdn/promise-semaphore"));exports.Memoize=function(r,t){var n;void 0===t&&(t={});var i=null!=(n=t.max)?n:1e3,a=function(){return JSON.stringify([].slice.call(arguments))},l=new e.LRUCache({ttl:t.ttl,max:i});return function(){var e=[].slice.call(arguments),t=a.apply(void 0,e);if(l.has(t))return l.get(t);var n=r.apply(void 0,e);return l.set(t,n),n}},exports.MemoizeAsync=function(r,n){var i;void 0===n&&(n={});var a=n.ttl,l=null!=(i=n.max)?i:1e3,u=function(){return JSON.stringify([].slice.call(arguments))},c=new t.default,o=new e.LRUCache({ttl:a,max:l});return function(){try{var e=[].slice.call(arguments),t=u.apply(void 0,e);return Promise.resolve(o.has(t)?o.get(t):function(n,i){try{var a=Promise.resolve(c.acquire(t)).then(function(){return o.has(t)?o.get(t):Promise.resolve(r.apply(void 0,e)).then(function(e){return o.set(t,e),e})})}catch(e){return i(!0,e)}return a&&a.then?a.then(i.bind(null,!1),i.bind(null,!0)):i(!1,a)}(0,function(e,r){if(c.release(t),e)throw r;return r}))}catch(e){return Promise.reject(e)}}};
//# sourceMappingURL=memoize.cjs.map
