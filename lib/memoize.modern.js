import{LRUCache as t}from"lru-cache";import r from"@chriscdn/promise-semaphore";const e=(r,e={})=>{var n,s;const a=null!=(n=e.max)?n:1e3,l=null!=(s=e.resolver)?s:(...t)=>JSON.stringify(t),o=new t({ttl:e.ttl,max:a});return(...t)=>{const e=l(...t);if(o.has(e))return o.get(e);{const n=r(...t);return o.set(e,n),n}}},n=(e,n={})=>{var s,a;const l=n.ttl,o=null!=(s=n.max)?s:1e3,i=null!=(a=n.resolver)?a:(...t)=>JSON.stringify(t),c=new r,u=new t({ttl:l,max:o});return async(...t)=>{const r=i(...t);if(u.has(r))return u.get(r);try{if(await c.acquire(r),u.has(r))return u.get(r);{const n=await e(...t);return u.set(r,n),n}}finally{c.release(r)}}};export{e as Memoize,n as MemoizeAsync};
//# sourceMappingURL=memoize.modern.js.map
