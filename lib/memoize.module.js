import e from"@chriscdn/promise-semaphore";import r from"quick-lru";var n=function(e,n){var t,i;void 0===n&&(n={});var a=null!=(t=n.maxSize)?t:1e3,l=null!=(i=n.resolver)?i:function(){return JSON.stringify([].slice.call(arguments))},o=new r({maxAge:n.maxAge,maxSize:a}),u=function(){var r=[].slice.call(arguments),n=l.apply(void 0,r);if(o.has(n))return o.get(n);var t=e.apply(void 0,r);return o.set(n,t),t};return u.cache=o,u},t=function(n,t){var i,a;void 0===t&&(t={});var l=t.maxAge,o=null!=(i=t.maxSize)?i:1e3,u=null!=(a=t.resolver)?a:function(){return JSON.stringify([].slice.call(arguments))},c=new e,s=new r({maxAge:l,maxSize:o}),v=function(){try{var e=[].slice.call(arguments),r=u.apply(void 0,e);return Promise.resolve(s.has(r)?s.get(r):function(t,i){try{var a=Promise.resolve(c.acquire(r)).then(function(){return s.has(r)?s.get(r):Promise.resolve(n.apply(void 0,e)).then(function(e){return s.set(r,e),e})})}catch(e){return i(!0,e)}return a&&a.then?a.then(i.bind(null,!1),i.bind(null,!0)):i(!1,a)}(0,function(e,n){if(c.release(r),e)throw n;return n}))}catch(e){return Promise.reject(e)}};return v.cache=s,v};export{n as Memoize,t as MemoizeAsync};
//# sourceMappingURL=memoize.module.js.map
