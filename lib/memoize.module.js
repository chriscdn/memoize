import{LRUCache as r}from"lru-cache";import e from"@chriscdn/promise-semaphore";var t=function(e,t){var n;void 0===t&&(t={});var i=null!=(n=t.max)?n:1e3,l=function(){return JSON.stringify([].slice.call(arguments))},o=new r({ttl:t.ttl,max:i});return function(){var r=[].slice.call(arguments),t=l.apply(void 0,r);if(o.has(t))return o.get(t);var n=e.apply(void 0,r);return o.set(t,n),n}},n=function(t,n){var i;void 0===n&&(n={});var l=n.ttl,o=null!=(i=n.max)?i:1e3,a=function(){return JSON.stringify([].slice.call(arguments))},u=new e,c=new r({ttl:l,max:o});return function(){try{var r=[].slice.call(arguments),e=a.apply(void 0,r);return Promise.resolve(c.has(e)?c.get(e):function(n,i){try{var l=Promise.resolve(u.acquire(e)).then(function(){return c.has(e)?c.get(e):Promise.resolve(t.apply(void 0,r)).then(function(r){return c.set(e,r),r})})}catch(r){return i(!0,r)}return l&&l.then?l.then(i.bind(null,!1),i.bind(null,!0)):i(!1,l)}(0,function(r,t){if(u.release(e),r)throw t;return t}))}catch(r){return Promise.reject(r)}}};export{t as Memoize,n as MemoizeAsync};
//# sourceMappingURL=memoize.module.js.map
